const a40_0x2370fd=a40_0x4855;(function(_0x4dc98d,_0x2ff026){const _0x40f28f=a40_0x4855,_0x5d9bbc=_0x4dc98d();while(!![]){try{const _0x1eac1a=parseInt(_0x40f28f(0x171))/0x1*(-parseInt(_0x40f28f(0x19d))/0x2)+parseInt(_0x40f28f(0x188))/0x3+parseInt(_0x40f28f(0x197))/0x4*(parseInt(_0x40f28f(0x18e))/0x5)+-parseInt(_0x40f28f(0x196))/0x6+parseInt(_0x40f28f(0x16a))/0x7+-parseInt(_0x40f28f(0x1a2))/0x8*(parseInt(_0x40f28f(0x181))/0x9)+parseInt(_0x40f28f(0x172))/0xa;if(_0x1eac1a===_0x2ff026)break;else _0x5d9bbc['push'](_0x5d9bbc['shift']());}catch(_0x1ff87a){_0x5d9bbc['push'](_0x5d9bbc['shift']());}}}(a40_0xe356,0xc6a0b));function a40_0xe356(){const _0x450ab0=['info','2430774FuzVmD','holder_name','/common/','yarn\x20dist','Coping\x20shared\x20files...','removeBaseDistDir','10nnsVzJ','mkdir\x20-p\x20','apps','copySourceFiles','inherit','removeTempFiles','yarn\x20install','assets','5297784DfRfML','77068FdnkBK','_copyDirIfExists','base_dir','/apps','bin','isArray','2669668sdFDSC','mv\x20','pkg_dir','/dist','./src/assets/**','2076968AuCNla','package.json','createWorkspacePkgJson','cwd','scripts','Coping\x20bot\x20files...','**/*.html','getPackage','9022307ZCQxBj','pkg\x20--public-packages\x20\x22*\x22\x20.\x20--public','copySharedFiles','/apps/','pkg','Install\x20bot\x20dependecies...','apps/*','1tXiAzr','14129260XYlDbJ','dist_dir','stringify','dist','exports','rsync\x20--recursive\x20--exclude\x20\x27node_modules\x27\x20--exclude\x20\x27.git\x27\x20','holder_dir','Alan\x20Bacelar\x20<alan@youfy.com.br>','workspace_dir','output_dir','error','shared','main','name','opts','18egmRXP','rm\x20-Rf\x20','ISC','_copyDir','changePkgForDist','bot_dir'];a40_0xe356=function(){return _0x450ab0;};return a40_0xe356();}const log=require('./logger'),findWorkspaceRoot=require('find-yarn-workspace-root'),{execSync}=require('child_process'),{resolve,basename}=require('path'),{writeFileSync,existsSync}=require('fs');class BotDistributor{constructor(_0x1efefb){const _0x41289c=a40_0x4855;this[_0x41289c(0x180)]={'base_dir':process[_0x41289c(0x165)](),'output_dir':'/tmp/yfy_bot_workspace_dist',..._0x1efefb},this[_0x41289c(0x19f)]=resolve(this['opts'][_0x41289c(0x199)],_0x41289c(0x1a3)),this[_0x41289c(0x16e)]=this[_0x41289c(0x169)](),this[_0x41289c(0x17a)]=findWorkspaceRoot(this[_0x41289c(0x180)][_0x41289c(0x199)])||this[_0x41289c(0x180)]['base_dir'],this[_0x41289c(0x178)]=resolve(this[_0x41289c(0x180)][_0x41289c(0x199)],'../'),this[_0x41289c(0x189)]=basename(this[_0x41289c(0x178)]),this[_0x41289c(0x186)]=resolve(this[_0x41289c(0x180)]['output_dir'],basename(this[_0x41289c(0x16e)][_0x41289c(0x17f)])),this['dist_dir']=resolve(this[_0x41289c(0x186)],_0x41289c(0x175));}['getPackage'](){const _0xa4580f=a40_0x4855;try{return require(this.pkg_dir);}catch(_0x53f38b){return console[_0xa4580f(0x17c)]('Package.json\x20not\x20found.\x20It\x20should\x20be\x20in\x20the\x20root\x20of\x20the\x20project.'),{};}}[a40_0x2370fd(0x184)](_0x11259a,_0x157240,{cwd:_0x4e5791}={}){const _0x353632=a40_0x2370fd;execSync(_0x353632(0x177)+_0x11259a+'\x20'+_0x157240,{'stdio':_0x353632(0x192),'cwd':_0x4e5791});}['_copyDirIfExists'](_0x651ded,_0x248d1e,_0x4565c5){existsSync(_0x651ded)&&this['_copyDir'](_0x651ded,_0x248d1e,_0x4565c5);}[a40_0x2370fd(0x193)](){const _0x3cd7ea=a40_0x2370fd,{output_dir:_0x5765d4}=this[_0x3cd7ea(0x180)];execSync(_0x3cd7ea(0x182)+_0x5765d4),execSync(_0x3cd7ea(0x182)+this[_0x3cd7ea(0x173)]);}[a40_0x2370fd(0x191)](){const _0x9403d9=a40_0x2370fd;log[_0x9403d9(0x187)](_0x9403d9(0x167)),execSync(_0x9403d9(0x18f)+this['bot_dir']);const {base_dir:_0x5e2cf9}=this[_0x9403d9(0x180)];this['_copyDir']('*',this['bot_dir'],{'cwd':_0x5e2cf9});}[a40_0x2370fd(0x16c)](){const _0x153f74=a40_0x2370fd;log['info'](_0x153f74(0x18c));const _0x15c97f=this[_0x153f74(0x180)]['output_dir'];execSync('mkdir\x20-p\x20'+_0x15c97f+'/'+this[_0x153f74(0x189)]),execSync(_0x153f74(0x18f)+_0x15c97f+_0x153f74(0x19a)),this[_0x153f74(0x198)](this[_0x153f74(0x17a)]+'/shared/',_0x15c97f+'/shared/'),this[_0x153f74(0x198)](this[_0x153f74(0x178)]+'/common/',_0x15c97f+'/'+this[_0x153f74(0x189)]+_0x153f74(0x18a)),this['_copyDirIfExists'](this[_0x153f74(0x178)]+_0x153f74(0x16d),_0x15c97f+'/'+this[_0x153f74(0x189)]+'/apps');const _0x54d28a=this[_0x153f74(0x16e)][_0x153f74(0x190)]||[];for(const _0xa5f77b of _0x54d28a){this['_copyDir'](this[_0x153f74(0x17a)]+_0x153f74(0x16d)+_0xa5f77b+'/',_0x15c97f+_0x153f74(0x16d)+_0xa5f77b+'/');}}['installDepedencies'](){const _0x131545=a40_0x2370fd;log[_0x131545(0x187)](_0x131545(0x16f));const {output_dir:_0x4aad1c}=this['opts'];execSync(_0x131545(0x194),{'stdio':'inherit','cwd':_0x4aad1c});}[a40_0x2370fd(0x185)](){const _0x4a1821=a40_0x2370fd,_0x4e8029=this[_0x4a1821(0x16e)];_0x4e8029[_0x4a1821(0x19b)]=_0x4e8029[_0x4a1821(0x19b)]||'./index.js',_0x4e8029[_0x4a1821(0x17e)]=_0x4e8029[_0x4a1821(0x17e)]||'./src/index.js';const _0x1b964f=_0x4e8029['pkg_extras']||{},_0x451b92=Array[_0x4a1821(0x19c)](_0x1b964f['assets'])?_0x1b964f[_0x4a1821(0x195)]:_0x1b964f['assets']?[_0x1b964f[_0x4a1821(0x195)]]:[];_0x4e8029['pkg']={'scripts':['**/*.js',..._0x1b964f[_0x4a1821(0x166)]||[]],'assets':[_0x4a1821(0x1a1),_0x4a1821(0x168),..._0x451b92],'outputPath':'dist'},_0x4e8029[_0x4a1821(0x166)]={..._0x4e8029[_0x4a1821(0x166)],'dist':_0x4a1821(0x16b)},writeFileSync(resolve(this[_0x4a1821(0x186)],_0x4a1821(0x1a3)),JSON[_0x4a1821(0x174)](_0x4e8029));}[a40_0x2370fd(0x175)](){const _0x3e4783=a40_0x2370fd;this[_0x3e4783(0x193)](),this[_0x3e4783(0x191)](),this['copySharedFiles'](),this[_0x3e4783(0x164)](),this[_0x3e4783(0x185)](),this['installDepedencies'](),execSync(_0x3e4783(0x18b),{'stdio':_0x3e4783(0x192),'cwd':this[_0x3e4783(0x186)]});}['moveToBaseDir'](){const _0x148b75=a40_0x2370fd;execSync(_0x148b75(0x19e)+this[_0x148b75(0x173)]+'\x20'+this[_0x148b75(0x180)][_0x148b75(0x199)]+_0x148b75(0x1a0));}[a40_0x2370fd(0x18d)](){const _0x5cd4e7=a40_0x2370fd;execSync(_0x5cd4e7(0x182)+this[_0x5cd4e7(0x180)]['base_dir']+_0x5cd4e7(0x1a0));}[a40_0x2370fd(0x164)](){const _0x59c522=a40_0x2370fd,_0x4b41d2={'name':'bots','private':!![],'workspaces':{'packages':[basename(this[_0x59c522(0x186)]),_0x59c522(0x17d),_0x59c522(0x170),this[_0x59c522(0x189)]+'/*']},'author':_0x59c522(0x179),'license':_0x59c522(0x183)};writeFileSync(resolve(this[_0x59c522(0x180)][_0x59c522(0x17b)],'package.json'),JSON[_0x59c522(0x174)](_0x4b41d2));}}function a40_0x4855(_0x2bab65,_0x44d478){const _0xe3568a=a40_0xe356();return a40_0x4855=function(_0x48553b,_0x1a57b3){_0x48553b=_0x48553b-0x164;let _0x2f9a3a=_0xe3568a[_0x48553b];return _0x2f9a3a;},a40_0x4855(_0x2bab65,_0x44d478);}module[a40_0x2370fd(0x176)]=BotDistributor;