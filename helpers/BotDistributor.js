const a40_0xfa604b=a40_0x17dc;function a40_0x435c(){const _0x33d20e=['mv\x20','mkdir\x20-p\x20','base_dir','795asvvHP','dist_dir','removeTempFiles','./index.js','./src/index.js','opts','cwd','/common/','changePkgForDist','copySourceFiles','/dist','23720DPWHUu','623RoZbiG','createWorkspacePkgJson','yarn\x20install','906636VuBPfG','_copyDir','**/*.js','/tmp/yfy_bot_workspace_dist','getPackage','/shared/','info','Coping\x20bot\x20files...','installDepedencies','name','4149233utgQLi','Package.json\x20not\x20found.\x20It\x20should\x20be\x20in\x20the\x20root\x20of\x20the\x20project.','package.json','Alan\x20Bacelar\x20<alan@youfy.com.br>','yarn\x20dist','pkg','30hYkxyP','bot_dir','workspace_dir','727100HogcHg','/apps','673542SnwGPm','removeBaseDistDir','holder_dir','dist','./src/assets/**','assets','moveToBaseDir','pkg_extras','2328pmhfxD','202318ilbenC','output_dir','error','Coping\x20shared\x20files...','pkg\x20--public-packages\x20\x22*\x22\x20.\x20--public','/apps/','copySharedFiles','1QGJCEK','main','holder_name','stringify','scripts','inherit','_copyDirIfExists','shared','rm\x20-Rf\x20'];a40_0x435c=function(){return _0x33d20e;};return a40_0x435c();}function a40_0x17dc(_0x445df4,_0x244432){const _0x435c56=a40_0x435c();return a40_0x17dc=function(_0x17dcb5,_0x3feff5){_0x17dcb5=_0x17dcb5-0x166;let _0x3993f9=_0x435c56[_0x17dcb5];return _0x3993f9;},a40_0x17dc(_0x445df4,_0x244432);}(function(_0x20af6c,_0x4dc748){const _0x46bfa7=a40_0x17dc,_0x1b3b3d=_0x20af6c();while(!![]){try{const _0x433327=parseInt(_0x46bfa7(0x177))/0x1*(parseInt(_0x46bfa7(0x170))/0x2)+parseInt(_0x46bfa7(0x183))/0x3*(parseInt(_0x46bfa7(0x16f))/0x4)+parseInt(_0x46bfa7(0x1a5))/0x5+parseInt(_0x46bfa7(0x192))/0x6+parseInt(_0x46bfa7(0x18f))/0x7*(-parseInt(_0x46bfa7(0x18e))/0x8)+-parseInt(_0x46bfa7(0x167))/0x9*(-parseInt(_0x46bfa7(0x1a2))/0xa)+-parseInt(_0x46bfa7(0x19c))/0xb;if(_0x433327===_0x4dc748)break;else _0x1b3b3d['push'](_0x1b3b3d['shift']());}catch(_0x2f06f7){_0x1b3b3d['push'](_0x1b3b3d['shift']());}}}(a40_0x435c,0x210ad));const log=require('./logger'),findWorkspaceRoot=require('find-yarn-workspace-root'),{execSync}=require('child_process'),{resolve,basename}=require('path'),{writeFileSync,existsSync}=require('fs');class BotDistributor{constructor(_0x350780){const _0x1c2255=a40_0x17dc;this[_0x1c2255(0x188)]={'base_dir':process[_0x1c2255(0x189)](),'output_dir':_0x1c2255(0x195),..._0x350780},this['pkg_dir']=resolve(this[_0x1c2255(0x188)][_0x1c2255(0x182)],'package.json'),this['pkg']=this[_0x1c2255(0x196)](),this[_0x1c2255(0x1a4)]=findWorkspaceRoot(this['opts'][_0x1c2255(0x182)])||this[_0x1c2255(0x188)][_0x1c2255(0x182)],this['holder_dir']=resolve(this[_0x1c2255(0x188)][_0x1c2255(0x182)],'../'),this['holder_name']=basename(this[_0x1c2255(0x169)]),this[_0x1c2255(0x1a3)]=resolve(this[_0x1c2255(0x188)][_0x1c2255(0x171)],basename(this[_0x1c2255(0x1a1)][_0x1c2255(0x19b)])),this[_0x1c2255(0x184)]=resolve(this[_0x1c2255(0x1a3)],_0x1c2255(0x16a));}[a40_0xfa604b(0x196)](){const _0x2a4ec6=a40_0xfa604b;try{return require(this.pkg_dir);}catch(_0x2db09a){return console[_0x2a4ec6(0x172)](_0x2a4ec6(0x19d)),{};}}[a40_0xfa604b(0x193)](_0x39a483,_0x2f60d8,{cwd:_0x316de2}={}){execSync('rsync\x20--recursive\x20--exclude\x20\x27node_modules\x27\x20--exclude\x20\x27.git\x27\x20'+_0x39a483+'\x20'+_0x2f60d8,{'stdio':'inherit','cwd':_0x316de2});}[a40_0xfa604b(0x17d)](_0x5bb366,_0x25182c,_0x2b6bcf){const _0x1e1f75=a40_0xfa604b;existsSync(_0x5bb366)&&this[_0x1e1f75(0x193)](_0x5bb366,_0x25182c,_0x2b6bcf);}[a40_0xfa604b(0x185)](){const _0x3d924d=a40_0xfa604b,{output_dir:_0x1c77e3}=this[_0x3d924d(0x188)];execSync(_0x3d924d(0x17f)+_0x1c77e3),execSync('rm\x20-Rf\x20'+this[_0x3d924d(0x184)]);}[a40_0xfa604b(0x18c)](){const _0x16c598=a40_0xfa604b;log['info'](_0x16c598(0x199)),execSync(_0x16c598(0x181)+this[_0x16c598(0x1a3)]);const {base_dir:_0x3a58a3}=this[_0x16c598(0x188)];this[_0x16c598(0x193)]('*',this[_0x16c598(0x1a3)],{'cwd':_0x3a58a3});}['copySharedFiles'](){const _0x27e0a7=a40_0xfa604b;log[_0x27e0a7(0x198)](_0x27e0a7(0x173));const _0x24a45c=this[_0x27e0a7(0x188)][_0x27e0a7(0x171)];execSync(_0x27e0a7(0x181)+_0x24a45c+'/'+this[_0x27e0a7(0x179)]),execSync(_0x27e0a7(0x181)+_0x24a45c+'/apps'),this[_0x27e0a7(0x17d)](this[_0x27e0a7(0x1a4)]+'/shared/',_0x24a45c+_0x27e0a7(0x197)),this[_0x27e0a7(0x17d)](this['holder_dir']+_0x27e0a7(0x18a),_0x24a45c+'/'+this['holder_name']+_0x27e0a7(0x18a)),this[_0x27e0a7(0x17d)](this['holder_dir']+_0x27e0a7(0x175),_0x24a45c+'/'+this[_0x27e0a7(0x179)]+_0x27e0a7(0x166));const _0x5404cf=this['pkg']['apps']||[];for(const _0x18504d of _0x5404cf){this[_0x27e0a7(0x193)](this[_0x27e0a7(0x1a4)]+_0x27e0a7(0x175)+_0x18504d+'/',_0x24a45c+_0x27e0a7(0x175)+_0x18504d+'/');}}[a40_0xfa604b(0x19a)](){const _0x40b278=a40_0xfa604b;log[_0x40b278(0x198)]('Install\x20bot\x20dependecies...');const {output_dir:_0x170fb9}=this[_0x40b278(0x188)];execSync(_0x40b278(0x191),{'stdio':_0x40b278(0x17c),'cwd':_0x170fb9});}[a40_0xfa604b(0x18b)](){const _0x4532c0=a40_0xfa604b,_0x273340=this[_0x4532c0(0x1a1)];_0x273340['bin']=_0x273340['bin']||_0x4532c0(0x186),_0x273340[_0x4532c0(0x178)]=_0x273340[_0x4532c0(0x178)]||_0x4532c0(0x187);const _0x552bbb=_0x273340[_0x4532c0(0x16e)]||{},_0x2fd4fa=Array['isArray'](_0x552bbb[_0x4532c0(0x16c)])?_0x552bbb['assets']:_0x552bbb['assets']?[_0x552bbb[_0x4532c0(0x16c)]]:[];_0x273340[_0x4532c0(0x1a1)]={'scripts':[_0x4532c0(0x194),..._0x552bbb['scripts']||[]],'assets':[_0x4532c0(0x16b),'**/*.html',..._0x2fd4fa],'outputPath':_0x4532c0(0x16a)},_0x273340[_0x4532c0(0x17b)]={..._0x273340[_0x4532c0(0x17b)],'dist':_0x4532c0(0x174)},writeFileSync(resolve(this[_0x4532c0(0x1a3)],'package.json'),JSON[_0x4532c0(0x17a)](_0x273340));}[a40_0xfa604b(0x16a)](){const _0x2bbe2e=a40_0xfa604b;this[_0x2bbe2e(0x185)](),this['copySourceFiles'](),this[_0x2bbe2e(0x176)](),this[_0x2bbe2e(0x190)](),this[_0x2bbe2e(0x18b)](),this[_0x2bbe2e(0x19a)](),execSync(_0x2bbe2e(0x1a0),{'stdio':'inherit','cwd':this[_0x2bbe2e(0x1a3)]});}[a40_0xfa604b(0x16d)](){const _0x522c9d=a40_0xfa604b;execSync(_0x522c9d(0x180)+this['dist_dir']+'\x20'+this[_0x522c9d(0x188)][_0x522c9d(0x182)]+'/dist');}[a40_0xfa604b(0x168)](){const _0x60eb5b=a40_0xfa604b;execSync(_0x60eb5b(0x17f)+this[_0x60eb5b(0x188)]['base_dir']+_0x60eb5b(0x18d));}[a40_0xfa604b(0x190)](){const _0x232642=a40_0xfa604b,_0x13cac8={'name':'bots','private':!![],'workspaces':{'packages':[basename(this[_0x232642(0x1a3)]),_0x232642(0x17e),'apps/*',this[_0x232642(0x179)]+'/*']},'author':_0x232642(0x19f),'license':'ISC'};writeFileSync(resolve(this['opts'][_0x232642(0x171)],_0x232642(0x19e)),JSON[_0x232642(0x17a)](_0x13cac8));}}module['exports']=BotDistributor;