const a40_0x2bcedb=a40_0x891e;(function(_0x4c650d,_0x97888b){const _0x2f1d03=a40_0x891e,_0x2b61fa=_0x4c650d();while(!![]){try{const _0x21562f=-parseInt(_0x2f1d03(0x17a))/0x1+parseInt(_0x2f1d03(0x14b))/0x2*(parseInt(_0x2f1d03(0x176))/0x3)+-parseInt(_0x2f1d03(0x14f))/0x4*(parseInt(_0x2f1d03(0x166))/0x5)+-parseInt(_0x2f1d03(0x177))/0x6+parseInt(_0x2f1d03(0x16f))/0x7*(-parseInt(_0x2f1d03(0x164))/0x8)+-parseInt(_0x2f1d03(0x156))/0x9+parseInt(_0x2f1d03(0x184))/0xa;if(_0x21562f===_0x97888b)break;else _0x2b61fa['push'](_0x2b61fa['shift']());}catch(_0x5e2ef7){_0x2b61fa['push'](_0x2b61fa['shift']());}}}(a40_0x5b32,0xe265d));function a40_0x891e(_0x43c943,_0x18a09b){const _0x5b32bf=a40_0x5b32();return a40_0x891e=function(_0x891e03,_0x8d0b74){_0x891e03=_0x891e03-0x144;let _0x4f2df2=_0x5b32bf[_0x891e03];return _0x4f2df2;},a40_0x891e(_0x43c943,_0x18a09b);}const log=require('./logger'),findWorkspaceRoot=require('find-yarn-workspace-root'),{execSync}=require('child_process'),{resolve,basename}=require('path'),{writeFileSync,existsSync}=require('fs');function a40_0x5b32(){const _0x5e02b7=['/shared/','_copyDir','pkg_dir','error','bot_dir','copySharedFiles','Coping\x20shared\x20files...','/dist','243248KLnIVC','isArray','56195VMUKeE','/apps/','/common/','/tmp/yfy_bot_workspace_dist','copySourceFiles','base_dir','./src/index.js','ISC','Package.json\x20not\x20found.\x20It\x20should\x20be\x20in\x20the\x20root\x20of\x20the\x20project.','112WqJzlV','opts','main','getPackage','inherit','changePkgForDist','holder_dir','3xxunUj','3211680iqUBLq','output_dir','createWorkspacePkgJson','1049863rmzlBr','installDepedencies','/apps','bin','mv\x20','shared','Coping\x20bot\x20files...','removeTempFiles','info','_copyDirIfExists','30578340dVOcwO','package.json','apps/*','workspace_dir','yarn\x20dist','dist_dir','assets','**/*.html','./src/assets/**','scripts','dist','61258oIIkbs','Install\x20bot\x20dependecies...','apps','pkg\x20--public-packages\x20\x22*\x22\x20.\x20--public','16UrCeEX','../','holder_name','mkdir\x20-p\x20','Alan\x20Bacelar\x20<alan@youfy.com.br>','moveToBaseDir','rm\x20-Rf\x20','400887kHpsRB','exports','removeBaseDistDir','stringify','pkg','cwd'];a40_0x5b32=function(){return _0x5e02b7;};return a40_0x5b32();}class BotDistributor{constructor(_0x4d6bc3){const _0x1604ac=a40_0x891e;this[_0x1604ac(0x170)]={'base_dir':process[_0x1604ac(0x15b)](),'output_dir':_0x1604ac(0x169),..._0x4d6bc3},this[_0x1604ac(0x15e)]=resolve(this[_0x1604ac(0x170)][_0x1604ac(0x16b)],_0x1604ac(0x185)),this['pkg']=this[_0x1604ac(0x172)](),this['workspace_dir']=findWorkspaceRoot(this['opts'][_0x1604ac(0x16b)])||this[_0x1604ac(0x170)][_0x1604ac(0x16b)],this['holder_dir']=resolve(this['opts']['base_dir'],_0x1604ac(0x150)),this['holder_name']=basename(this[_0x1604ac(0x175)]),this[_0x1604ac(0x160)]=resolve(this[_0x1604ac(0x170)][_0x1604ac(0x178)],basename(this[_0x1604ac(0x15a)]['name'])),this[_0x1604ac(0x145)]=resolve(this['bot_dir'],'dist');}['getPackage'](){const _0x51ba84=a40_0x891e;try{return require(this.pkg_dir);}catch(_0x179f6d){return console[_0x51ba84(0x15f)](_0x51ba84(0x16e)),{};}}[a40_0x2bcedb(0x15d)](_0x442741,_0x332496,{cwd:_0x4e7223}={}){const _0x381b12=a40_0x2bcedb;execSync('rsync\x20--recursive\x20--exclude\x20\x27node_modules\x27\x20--exclude\x20\x27.git\x27\x20'+_0x442741+'\x20'+_0x332496,{'stdio':_0x381b12(0x173),'cwd':_0x4e7223});}[a40_0x2bcedb(0x183)](_0x12108d,_0x24d26a,_0x4cc40a){existsSync(_0x12108d)&&this['_copyDir'](_0x12108d,_0x24d26a,_0x4cc40a);}[a40_0x2bcedb(0x181)](){const _0x103e7f=a40_0x2bcedb,{output_dir:_0x53f11d}=this[_0x103e7f(0x170)];execSync(_0x103e7f(0x155)+_0x53f11d),execSync(_0x103e7f(0x155)+this['dist_dir']);}[a40_0x2bcedb(0x16a)](){const _0x1d9e33=a40_0x2bcedb;log[_0x1d9e33(0x182)](_0x1d9e33(0x180)),execSync('mkdir\x20-p\x20'+this['bot_dir']);const {base_dir:_0x1cee12}=this[_0x1d9e33(0x170)];this[_0x1d9e33(0x15d)]('*',this[_0x1d9e33(0x160)],{'cwd':_0x1cee12});}['copySharedFiles'](){const _0x40d37d=a40_0x2bcedb;log[_0x40d37d(0x182)](_0x40d37d(0x162));const _0x42a9c9=this[_0x40d37d(0x170)][_0x40d37d(0x178)];execSync(_0x40d37d(0x152)+_0x42a9c9+'/'+this[_0x40d37d(0x151)]),execSync('mkdir\x20-p\x20'+_0x42a9c9+_0x40d37d(0x17c)),this['_copyDirIfExists'](this[_0x40d37d(0x187)]+_0x40d37d(0x15c),_0x42a9c9+_0x40d37d(0x15c)),this[_0x40d37d(0x183)](this[_0x40d37d(0x175)]+_0x40d37d(0x168),_0x42a9c9+'/'+this[_0x40d37d(0x151)]+_0x40d37d(0x168)),this['_copyDirIfExists'](this[_0x40d37d(0x175)]+_0x40d37d(0x167),_0x42a9c9+'/'+this[_0x40d37d(0x151)]+_0x40d37d(0x17c));const _0x17dba5=this[_0x40d37d(0x15a)][_0x40d37d(0x14d)]||[];for(const _0x47e2dc of _0x17dba5){this[_0x40d37d(0x15d)](this[_0x40d37d(0x187)]+'/apps/'+_0x47e2dc+'/',_0x42a9c9+_0x40d37d(0x167)+_0x47e2dc+'/');}}[a40_0x2bcedb(0x17b)](){const _0x114e30=a40_0x2bcedb;log[_0x114e30(0x182)](_0x114e30(0x14c));const {output_dir:_0x3c2a67}=this[_0x114e30(0x170)];execSync('yarn\x20install',{'stdio':_0x114e30(0x173),'cwd':_0x3c2a67});}[a40_0x2bcedb(0x174)](){const _0x3196d2=a40_0x2bcedb,_0x24a5d7=this['pkg'];_0x24a5d7[_0x3196d2(0x17d)]=_0x24a5d7['bin']||'./index.js',_0x24a5d7[_0x3196d2(0x171)]=_0x24a5d7[_0x3196d2(0x171)]||_0x3196d2(0x16c);const _0x195a32=_0x24a5d7['pkg_extras']||{},_0x5b8264=Array[_0x3196d2(0x165)](_0x195a32['assets'])?_0x195a32[_0x3196d2(0x146)]:_0x195a32['assets']?[_0x195a32[_0x3196d2(0x146)]]:[];_0x24a5d7[_0x3196d2(0x15a)]={'scripts':['**/*.js',..._0x195a32[_0x3196d2(0x149)]||[]],'assets':[_0x3196d2(0x148),_0x3196d2(0x147),..._0x5b8264],'outputPath':_0x3196d2(0x14a)},_0x24a5d7[_0x3196d2(0x149)]={..._0x24a5d7['scripts'],'dist':_0x3196d2(0x14e)},writeFileSync(resolve(this[_0x3196d2(0x160)],_0x3196d2(0x185)),JSON[_0x3196d2(0x159)](_0x24a5d7));}['dist'](){const _0x23949a=a40_0x2bcedb;this[_0x23949a(0x181)](),this['copySourceFiles'](),this[_0x23949a(0x161)](),this[_0x23949a(0x179)](),this[_0x23949a(0x174)](),this['installDepedencies'](),execSync(_0x23949a(0x144),{'stdio':_0x23949a(0x173),'cwd':this['bot_dir']});}[a40_0x2bcedb(0x154)](){const _0x29b995=a40_0x2bcedb;execSync(_0x29b995(0x17e)+this[_0x29b995(0x145)]+'\x20'+this['opts'][_0x29b995(0x16b)]+_0x29b995(0x163));}[a40_0x2bcedb(0x158)](){const _0x43b4da=a40_0x2bcedb;execSync(_0x43b4da(0x155)+this['opts'][_0x43b4da(0x16b)]+_0x43b4da(0x163));}['createWorkspacePkgJson'](){const _0x26614c=a40_0x2bcedb,_0x1bf208={'name':'bots','private':!![],'workspaces':{'packages':[basename(this[_0x26614c(0x160)]),_0x26614c(0x17f),_0x26614c(0x186),this['holder_name']+'/*']},'author':_0x26614c(0x153),'license':_0x26614c(0x16d)};writeFileSync(resolve(this['opts'][_0x26614c(0x178)],_0x26614c(0x185)),JSON[_0x26614c(0x159)](_0x1bf208));}}module[a40_0x2bcedb(0x157)]=BotDistributor;