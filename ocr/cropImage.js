const a51_0x5eefa2=a51_0x158e;function a51_0x3de2(){const _0xd66ee1=['message','8LxPFyl','coords','12177FMfYQZ','668973mzwEyv','exports','.jpg','4730qhQCyo','25HcatFG','2235507DVeUUo','payload','5182226hIQcae','abs','127466DeEKXv','file_width','read','72624dwmTZU','resize','write','2545840VJoeCQ','output_dir','[CROP\x20ERROR]','round','width'];a51_0x3de2=function(){return _0xd66ee1;};return a51_0x3de2();}function a51_0x158e(_0x3eddeb,_0x59fa9e){const _0x3de279=a51_0x3de2();return a51_0x158e=function(_0x158e2a,_0x4bce17){_0x158e2a=_0x158e2a-0x102;let _0x5eba47=_0x3de279[_0x158e2a];return _0x5eba47;},a51_0x158e(_0x3eddeb,_0x59fa9e);}(function(_0x150a5c,_0x64f027){const _0x2f3587=a51_0x158e,_0x160192=_0x150a5c();while(!![]){try{const _0x48a56d=parseInt(_0x2f3587(0x116))/0x1+-parseInt(_0x2f3587(0x107))/0x2+-parseInt(_0x2f3587(0x103))/0x3+parseInt(_0x2f3587(0x10d))/0x4+parseInt(_0x2f3587(0x102))/0x5*(-parseInt(_0x2f3587(0x10a))/0x6)+-parseInt(_0x2f3587(0x105))/0x7*(-parseInt(_0x2f3587(0x113))/0x8)+-parseInt(_0x2f3587(0x115))/0x9*(parseInt(_0x2f3587(0x119))/0xa);if(_0x48a56d===_0x64f027)break;else _0x160192['push'](_0x160192['shift']());}catch(_0x46742c){_0x160192['push'](_0x160192['shift']());}}}(a51_0x3de2,0x82f28));const os=require('os'),{resolve}=require('path'),jimp=require('jimp'),{promisify}=require('util'),sizeOf=promisify(require('image-size')),apply_factor=(_0x1fd87a,_0x47d7cb)=>Math[a51_0x5eefa2(0x110)](parseInt(_0x1fd87a)*_0x47d7cb);module[a51_0x5eefa2(0x117)]=async function cropImage(_0x55e117,_0x2b41c9,_0x3b3993={}){const _0x2e0b3c=a51_0x5eefa2,_0x4602b3={'output_dir':os['tmpdir'](),'file_width':0x9af,..._0x3b3993},_0x367151=resolve(_0x4602b3[_0x2e0b3c(0x10e)],_0x55e117['id']+_0x2e0b3c(0x118)),_0x475e8f=await sizeOf(_0x2b41c9)||{'width':0x0,'height':0x0},_0x36b156=_0x475e8f[_0x2e0b3c(0x111)]/_0x4602b3[_0x2e0b3c(0x108)],_0x3a07ad=_0x55e117[_0x2e0b3c(0x104)]||{},_0x3160ab=_0x3a07ad[_0x2e0b3c(0x114)]||_0x55e117['coordinates']||'0,0,0,0',_0x5cb4b0=_0x3160ab['split'](','),_0x35d84d=apply_factor(_0x5cb4b0[0x0],_0x36b156),_0x1a8509=apply_factor(_0x5cb4b0[0x1],_0x36b156),_0x159d38=apply_factor(_0x5cb4b0[0x2],_0x36b156),_0x271a0b=apply_factor(_0x5cb4b0[0x3],_0x36b156),_0x1525b4=Math['abs'](_0x159d38-_0x35d84d),_0x401421=Math[_0x2e0b3c(0x106)](_0x271a0b-_0x1a8509),_0x3d70a1=0x1;try{const _0x2bbf3b=await jimp[_0x2e0b3c(0x109)](_0x2b41c9);return await _0x2bbf3b['crop'](_0x35d84d,_0x1a8509,_0x1525b4,_0x401421),await _0x2bbf3b[_0x2e0b3c(0x10b)](Math[_0x2e0b3c(0x110)](_0x1525b4*_0x3d70a1),Math[_0x2e0b3c(0x110)](_0x401421*_0x3d70a1)),await _0x2bbf3b[_0x2e0b3c(0x10c)](_0x367151),await timer['sleep'](0x12c),_0x367151;}catch(_0x1ba0dd){console['warn'](_0x2e0b3c(0x10f),_0x1ba0dd[_0x2e0b3c(0x112)]);}return null;};