const a65_0x3cc635=a65_0x3b36;(function(_0x344fea,_0x10d575){const _0x1728b7=a65_0x3b36,_0x45c114=_0x344fea();while(!![]){try{const _0x451a83=-parseInt(_0x1728b7(0xb5))/0x1+-parseInt(_0x1728b7(0x99))/0x2+parseInt(_0x1728b7(0x9b))/0x3*(-parseInt(_0x1728b7(0xa4))/0x4)+-parseInt(_0x1728b7(0xa8))/0x5*(parseInt(_0x1728b7(0xab))/0x6)+-parseInt(_0x1728b7(0x9f))/0x7*(-parseInt(_0x1728b7(0xa3))/0x8)+parseInt(_0x1728b7(0xac))/0x9*(-parseInt(_0x1728b7(0xbb))/0xa)+parseInt(_0x1728b7(0xb8))/0xb*(parseInt(_0x1728b7(0xb0))/0xc);if(_0x451a83===_0x10d575)break;else _0x45c114['push'](_0x45c114['shift']());}catch(_0x5033be){_0x45c114['push'](_0x45c114['shift']());}}}(a65_0x46f9,0x35927));const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');class OCR{[a65_0x3cc635(0xa9)](_0x3019bb={}){const _0x1a076d=a65_0x3cc635,_0x5f3cf3={'cleanup':!![],..._0x3019bb};this['output_dir']=resolve(os[_0x1a076d(0xa2)](),_0x1a076d(0x9a)),_0x5f3cf3['cleanup']&&this['__cleanup'](),!existsSync(this[_0x1a076d(0xba)])&&mkdirSync(this['output_dir'],{'recursive':!![],'force':!![]});}async['readPDF'](_0x1c42f0){const _0x5aa31d=a65_0x3cc635;this['init']();const _0x1cfe0=this[_0x5aa31d(0xba)],_0x4419a9=await convertPDF(_0x1c42f0,{'output_dir':_0x1cfe0});return await this[_0x5aa31d(0xa0)](_0x4419a9,{'cleanup':![]});}async['readImage'](_0x5d5c78,_0x4e0a9a={}){const _0x558027=a65_0x3cc635;this[_0x558027(0xa9)](_0x4e0a9a);const _0x4743d7=this['output_dir'],_0x25bec0=await readLargeImage(_0x5d5c78,{'lang':_0x558027(0xaa),'output_dir':_0x4743d7});logger['info']('Finding\x20better\x20template\x20for\x20OCR...');const _0x2d5b79=await OCRTemplateApi[_0x558027(0xb7)](_0x25bec0);if(!_0x2d5b79?.[_0x558027(0xb2)])throw new ValidationError(_0x558027(0xa6));const {items:_0x5556bf,template:_0x580c8d}=_0x2d5b79,{width:_0x586f4a}=_0x580c8d[_0x558027(0xa7)]||{'width':0x0};logger[_0x558027(0x9c)](_0x558027(0xb3)+_0x580c8d[_0x558027(0xaf)]+_0x558027(0xa5)+_0x580c8d[_0x558027(0xad)]+_0x558027(0xa1)+_0x5556bf[_0x558027(0xb9)]+_0x558027(0xbc)+_0x580c8d['similarity']);const _0x384930={'__template':_0x580c8d};for(const _0x295bac of _0x5556bf){logger[_0x558027(0xae)]('Extracting\x20'+_0x295bac['id']+_0x558027(0x9e));const _0x5e95f7=_0x295bac[_0x558027(0xb6)][_0x558027(0xb1)]||[],_0x4d2695=await cropImage(_0x295bac,_0x5d5c78,{'output_dir':_0x4743d7,'file_width':_0x586f4a});if(_0x4d2695&&existsSync(_0x4d2695)){const _0x29f2ac=await readImage(_0x4d2695,{'output_dir':_0x4743d7,'rules':_0x5e95f7});_0x384930[_0x295bac['id']]=_0x29f2ac;}else _0x384930[_0x295bac['id']]='';}return this[_0x558027(0xbd)](),_0x384930;}[a65_0x3cc635(0xbd)](){const _0x426f26=a65_0x3cc635;try{existsSync(this[_0x426f26(0xba)])&&rmSync(this[_0x426f26(0xba)],{'recursive':!![],'force':!![]});}catch(_0x19c061){console['warn'](_0x426f26(0x9d),_0x19c061[_0x426f26(0xb4)]);}}}function a65_0x3b36(_0x332a30,_0x27895e){const _0x46f92f=a65_0x46f9();return a65_0x3b36=function(_0x3b36a0,_0x19c637){_0x3b36a0=_0x3b36a0-0x99;let _0x47497b=_0x46f92f[_0x3b36a0];return _0x47497b;},a65_0x3b36(_0x332a30,_0x27895e);}function a65_0x46f9(){const _0x147ec2=['.\x20Amount\x20of\x20items:\x20','tmpdir','16GnwQSf','4460BiIWop','\x20from\x20','OCR\x20Template\x20not\x20found.','file_attributes','985LVMhac','init','por','9474fANQCU','531666mBOdsN','company_id','info','name','12128388NjXaBQ','rules','template','Template\x20found:\x20','message','89838lrCxBV','config','find','11wcEhCv','length','output_dir','30yXoQIU','.\x20Similarity:\x20','__cleanup','127152gLsYCD','yfy-ocr','993peKCkd','muted','Fail\x20to\x20remove\x20tmp\x20dir','\x27s\x20text...','768236Yywhzz','readImage'];a65_0x46f9=function(){return _0x147ec2;};return a65_0x46f9();}module['exports']=new OCR();