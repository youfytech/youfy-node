const a65_0x3c2904=a65_0x17ce;(function(_0x133254,_0x3bc596){const _0x4f601a=a65_0x17ce,_0x31d7f2=_0x133254();while(!![]){try{const _0x4412bb=parseInt(_0x4f601a(0xbf))/0x1*(-parseInt(_0x4f601a(0xc3))/0x2)+-parseInt(_0x4f601a(0xd8))/0x3+-parseInt(_0x4f601a(0xc8))/0x4*(-parseInt(_0x4f601a(0xd6))/0x5)+-parseInt(_0x4f601a(0xbb))/0x6+-parseInt(_0x4f601a(0xd9))/0x7+-parseInt(_0x4f601a(0xd5))/0x8+-parseInt(_0x4f601a(0xc2))/0x9*(-parseInt(_0x4f601a(0xcb))/0xa);if(_0x4412bb===_0x3bc596)break;else _0x31d7f2['push'](_0x31d7f2['shift']());}catch(_0x16350b){_0x31d7f2['push'](_0x31d7f2['shift']());}}}(a65_0x19ab,0x62f3a));const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');function a65_0x19ab(){const _0x7d1a8d=['Template\x20found:\x20','init','name','__cleanup','4789160ZXlKcd','2387305TJlmSd','.\x20Similarity:\x20','941703uwTbnM','4293653dzkhej','find','readPDF','rules','readImage','Fail\x20to\x20remove\x20tmp\x20dir','tmpdir','361182pAHWkK','config','\x20from\x20','Extracting\x20','9yBiznt','\x27s\x20text...','OCR\x20Template\x20not\x20found.','4896iwHklV','96466RRHktv','por','template','info','length','4Wmqxwt','file_attributes','muted','35810rYTlHD','warn','cleanup','.\x20Amount\x20of\x20items:\x20','output_dir','Finding\x20better\x20template\x20for\x20OCR...'];a65_0x19ab=function(){return _0x7d1a8d;};return a65_0x19ab();}class OCR{['init'](_0x25a980={}){const _0x7c9f27=a65_0x17ce,_0x575e69={'cleanup':!![],..._0x25a980};this[_0x7c9f27(0xcf)]=resolve(os[_0x7c9f27(0xba)](),'yfy-ocr'),_0x575e69[_0x7c9f27(0xcd)]&&this[_0x7c9f27(0xd4)](),!existsSync(this[_0x7c9f27(0xcf)])&&mkdirSync(this[_0x7c9f27(0xcf)],{'recursive':!![],'force':!![]});}async[a65_0x3c2904(0xdb)](_0x50b433){const _0xe7f443=a65_0x3c2904;this[_0xe7f443(0xd2)]();const _0x1c1cc7=this['output_dir'],_0x31fdbb=await convertPDF(_0x50b433,{'output_dir':_0x1c1cc7});return await this[_0xe7f443(0xdd)](_0x31fdbb,{'cleanup':![]});}async['readImage'](_0x54939c,_0x3e3cb3={}){const _0x310d15=a65_0x3c2904;this[_0x310d15(0xd2)](_0x3e3cb3);const _0x107850=this[_0x310d15(0xcf)],_0x654e8e=await readLargeImage(_0x54939c,{'lang':_0x310d15(0xc4),'output_dir':_0x107850});logger[_0x310d15(0xc6)](_0x310d15(0xd0));const _0x5afab0=await OCRTemplateApi[_0x310d15(0xda)](_0x654e8e);if(!_0x5afab0?.[_0x310d15(0xc5)])throw new ValidationError(_0x310d15(0xc1));const {items:_0x5e547c,template:_0x406ce3}=_0x5afab0,{width:_0x23a5d0}=_0x406ce3[_0x310d15(0xc9)]||{'width':0x0};logger[_0x310d15(0xca)](_0x310d15(0xd1)+_0x406ce3[_0x310d15(0xd3)]+_0x310d15(0xbd)+_0x406ce3['company_id']+_0x310d15(0xce)+_0x5e547c[_0x310d15(0xc7)]+_0x310d15(0xd7)+_0x406ce3['similarity']);const _0x3d3ef9={'__template':_0x406ce3};for(const _0x38de9e of _0x5e547c){logger[_0x310d15(0xc6)](_0x310d15(0xbe)+_0x38de9e['id']+_0x310d15(0xc0));const _0x3f93ba=_0x38de9e[_0x310d15(0xbc)][_0x310d15(0xdc)]||[],_0x143c7b=await cropImage(_0x38de9e,_0x54939c,{'output_dir':_0x107850,'file_width':_0x23a5d0});if(_0x143c7b&&existsSync(_0x143c7b)){const _0x195ad5=await readImage(_0x143c7b,{'output_dir':_0x107850,'rules':_0x3f93ba});_0x3d3ef9[_0x38de9e['id']]=_0x195ad5;}else _0x3d3ef9[_0x38de9e['id']]='';}return this[_0x310d15(0xd4)](),_0x3d3ef9;}[a65_0x3c2904(0xd4)](){const _0x56dfbb=a65_0x3c2904;try{existsSync(this[_0x56dfbb(0xcf)])&&rmSync(this['output_dir'],{'recursive':!![],'force':!![]});}catch(_0x99c018){console[_0x56dfbb(0xcc)](_0x56dfbb(0xde),_0x99c018['message']);}}}function a65_0x17ce(_0x2ad5eb,_0x4119cd){const _0x19ab40=a65_0x19ab();return a65_0x17ce=function(_0x17ce72,_0xb41b74){_0x17ce72=_0x17ce72-0xba;let _0x3fac18=_0x19ab40[_0x17ce72];return _0x3fac18;},a65_0x17ce(_0x2ad5eb,_0x4119cd);}module['exports']=new OCR();