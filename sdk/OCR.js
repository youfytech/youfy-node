const a65_0x334673=a65_0x38a9;(function(_0x2503ba,_0x3f04a1){const _0x1b1053=a65_0x38a9,_0x4c706c=_0x2503ba();while(!![]){try{const _0x4e2353=-parseInt(_0x1b1053(0x212))/0x1+parseInt(_0x1b1053(0x209))/0x2+parseInt(_0x1b1053(0x213))/0x3+-parseInt(_0x1b1053(0x1f6))/0x4*(-parseInt(_0x1b1053(0x204))/0x5)+parseInt(_0x1b1053(0x1ff))/0x6*(-parseInt(_0x1b1053(0x1f2))/0x7)+parseInt(_0x1b1053(0x208))/0x8*(parseInt(_0x1b1053(0x1f3))/0x9)+-parseInt(_0x1b1053(0x211))/0xa;if(_0x4e2353===_0x3f04a1)break;else _0x4c706c['push'](_0x4c706c['shift']());}catch(_0x1135a5){_0x4c706c['push'](_0x4c706c['shift']());}}}(a65_0x3548,0x766c4));function a65_0x38a9(_0x1fb4cb,_0x1be033){const _0x35486c=a65_0x3548();return a65_0x38a9=function(_0x38a9b7,_0xbe1914){_0x38a9b7=_0x38a9b7-0x1ef;let _0x331396=_0x35486c[_0x38a9b7];return _0x331396;},a65_0x38a9(_0x1fb4cb,_0x1be033);}const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');class OCR{[a65_0x334673(0x20b)](_0x14cb2e={}){const _0x13c51e=a65_0x334673,_0x51afa9={'cleanup':!![],..._0x14cb2e};this['output_dir']=resolve(os[_0x13c51e(0x1f9)](),_0x13c51e(0x1f7)),_0x51afa9[_0x13c51e(0x1fa)]&&this[_0x13c51e(0x1f5)](),!existsSync(this[_0x13c51e(0x201)])&&mkdirSync(this[_0x13c51e(0x201)],{'recursive':!![],'force':!![]});}async['readPDF'](_0x4148a5){const _0x1971d8=a65_0x334673;this[_0x1971d8(0x20b)]();const _0xb513e1=this[_0x1971d8(0x201)],_0x3435cc=await convertPDF(_0x4148a5,{'output_dir':_0xb513e1});return await this[_0x1971d8(0x20d)](_0x3435cc,{'cleanup':![]});}async[a65_0x334673(0x20d)](_0x254810,_0x3a4fd1={}){const _0x2245c4=a65_0x334673;this[_0x2245c4(0x20b)](_0x3a4fd1);const _0x342f82=this[_0x2245c4(0x201)],_0x3ba20e=await readLargeImage(_0x254810,{'lang':_0x2245c4(0x20e),'output_dir':_0x342f82});logger[_0x2245c4(0x1f8)](_0x2245c4(0x214));const _0x1530df=await OCRTemplateApi[_0x2245c4(0x20a)](_0x3ba20e);if(!_0x1530df?.['template'])throw new ValidationError(_0x2245c4(0x1f4));const {items:_0x28f92d,template:_0x41117c}=_0x1530df,{width:_0x25a18a}=_0x41117c[_0x2245c4(0x207)]||{'width':0x0};logger[_0x2245c4(0x203)](_0x2245c4(0x1ef)+_0x41117c[_0x2245c4(0x1fe)]+_0x2245c4(0x200)+_0x41117c[_0x2245c4(0x20f)]+_0x2245c4(0x1f1)+_0x28f92d[_0x2245c4(0x1fb)]+_0x2245c4(0x205)+_0x41117c['similarity']);const _0x1b299b={'__template':_0x41117c};for(const _0x1a17c1 of _0x28f92d){logger[_0x2245c4(0x1f8)](_0x2245c4(0x210)+_0x1a17c1['id']+_0x2245c4(0x1f0));const _0x3bf121=_0x1a17c1[_0x2245c4(0x20c)][_0x2245c4(0x1fc)]||[],_0xaaaf=await cropImage(_0x1a17c1,_0x254810,{'output_dir':_0x342f82,'file_width':_0x25a18a});if(_0xaaaf&&existsSync(_0xaaaf)){const _0x2ad9a7=await readImage(_0xaaaf,{'output_dir':_0x342f82,'rules':_0x3bf121});_0x1b299b[_0x1a17c1['id']]=_0x2ad9a7;}else _0x1b299b[_0x1a17c1['id']]='';}return this[_0x2245c4(0x1f5)](),_0x1b299b;}[a65_0x334673(0x1f5)](){const _0x5c2246=a65_0x334673;try{existsSync(this['output_dir'])&&rmSync(this[_0x5c2246(0x201)],{'recursive':!![],'force':!![]});}catch(_0x2e429f){console[_0x5c2246(0x202)](_0x5c2246(0x206),_0x2e429f[_0x5c2246(0x215)]);}}}module[a65_0x334673(0x1fd)]=new OCR();function a65_0x3548(){const _0x22ef0b=['length','rules','exports','name','5614134frZsix','\x20from\x20','output_dir','warn','muted','611135MZYIor','.\x20Similarity:\x20','Fail\x20to\x20remove\x20tmp\x20dir','file_attributes','5646048DAPrgI','1826776SLFhWj','find','init','config','readImage','por','company_id','Extracting\x20','4342600UHHfMp','647483eKGZXC','83277GAmSXR','Finding\x20better\x20template\x20for\x20OCR...','message','Template\x20found:\x20','\x27s\x20text...','.\x20Amount\x20of\x20items:\x20','7nPLSvg','9oPQdlE','OCR\x20Template\x20not\x20found.','__cleanup','28jkOufu','yfy-ocr','info','tmpdir','cleanup'];a65_0x3548=function(){return _0x22ef0b;};return a65_0x3548();}