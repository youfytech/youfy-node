const a65_0x4d113b=a65_0x5301;(function(_0x3928f7,_0x533dbb){const _0x2d079b=a65_0x5301,_0x662905=_0x3928f7();while(!![]){try{const _0x276543=-parseInt(_0x2d079b(0x1f5))/0x1*(-parseInt(_0x2d079b(0x205))/0x2)+-parseInt(_0x2d079b(0x1f7))/0x3+parseInt(_0x2d079b(0x1ea))/0x4+parseInt(_0x2d079b(0x1fe))/0x5+parseInt(_0x2d079b(0x1f9))/0x6*(-parseInt(_0x2d079b(0x20d))/0x7)+-parseInt(_0x2d079b(0x20a))/0x8*(parseInt(_0x2d079b(0x1f3))/0x9)+-parseInt(_0x2d079b(0x200))/0xa;if(_0x276543===_0x533dbb)break;else _0x662905['push'](_0x662905['shift']());}catch(_0x4edfc0){_0x662905['push'](_0x662905['shift']());}}}(a65_0x28d2,0x8a3e9));function a65_0x28d2(){const _0x26fc7c=['similarity','yfy-ocr','tmpdir','message','8PtZevJ','exports','\x20from\x20','164185IhnyPI','4256032JGyBlN','.\x20Amount\x20of\x20items:\x20','warn','OCR\x20Template\x20not\x20found.','name','info','Extracting\x20','Finding\x20better\x20template\x20for\x20OCR...','.\x20Similarity:\x20','8993151cpTwCB','\x27s\x20text...','497066dTBryU','readPDF','134334ushHqy','__cleanup','36ZqtzVd','readImage','company_id','length','file_attributes','1907550rkSibo','init','6886540YeNCer','Template\x20found:\x20','output_dir','template','rules','4RgatXi'];a65_0x28d2=function(){return _0x26fc7c;};return a65_0x28d2();}function a65_0x5301(_0xb747cb,_0x2c0a79){const _0x28d263=a65_0x28d2();return a65_0x5301=function(_0x530183,_0x181edd){_0x530183=_0x530183-0x1ea;let _0x2dbc57=_0x28d263[_0x530183];return _0x2dbc57;},a65_0x5301(_0xb747cb,_0x2c0a79);}const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');class OCR{[a65_0x4d113b(0x1ff)](_0x120ac9={}){const _0x20ad13=a65_0x4d113b,_0x13f743={'cleanup':!![],..._0x120ac9};this[_0x20ad13(0x202)]=resolve(os[_0x20ad13(0x208)](),_0x20ad13(0x207)),_0x13f743['cleanup']&&this[_0x20ad13(0x1f8)](),!existsSync(this[_0x20ad13(0x202)])&&mkdirSync(this[_0x20ad13(0x202)],{'recursive':!![],'force':!![]});}async[a65_0x4d113b(0x1f6)](_0x25d77a){const _0x5738ce=a65_0x4d113b;this[_0x5738ce(0x1ff)]();const _0x49f22d=this[_0x5738ce(0x202)],_0x56ce4c=await convertPDF(_0x25d77a,{'output_dir':_0x49f22d});return await this[_0x5738ce(0x1fa)](_0x56ce4c,{'cleanup':![]});}async[a65_0x4d113b(0x1fa)](_0x3f0292,_0x25cb1b={}){const _0x2e83b1=a65_0x4d113b;this[_0x2e83b1(0x1ff)](_0x25cb1b);const _0x1cf071=this['output_dir'],_0x2ce7cb=await readLargeImage(_0x3f0292,{'lang':'por','output_dir':_0x1cf071});logger[_0x2e83b1(0x1ef)](_0x2e83b1(0x1f1));const _0x259c14=await OCRTemplateApi['find'](_0x2ce7cb);if(!_0x259c14?.[_0x2e83b1(0x203)])throw new ValidationError(_0x2e83b1(0x1ed));const {items:_0x53211a,template:_0x350cf8}=_0x259c14,{width:_0x4ab53d}=_0x350cf8[_0x2e83b1(0x1fd)]||{'width':0x0};logger['muted'](_0x2e83b1(0x201)+_0x350cf8[_0x2e83b1(0x1ee)]+_0x2e83b1(0x20c)+_0x350cf8[_0x2e83b1(0x1fb)]+_0x2e83b1(0x1eb)+_0x53211a[_0x2e83b1(0x1fc)]+_0x2e83b1(0x1f2)+_0x350cf8[_0x2e83b1(0x206)]);const _0x582598={'__template':_0x350cf8};for(const _0x39a813 of _0x53211a){logger[_0x2e83b1(0x1ef)](_0x2e83b1(0x1f0)+_0x39a813['id']+_0x2e83b1(0x1f4));const _0x3d18f0=_0x39a813['config'][_0x2e83b1(0x204)]||[],_0x102249=await cropImage(_0x39a813,_0x3f0292,{'output_dir':_0x1cf071,'file_width':_0x4ab53d});if(_0x102249&&existsSync(_0x102249)){const _0x1fb748=await readImage(_0x102249,{'output_dir':_0x1cf071,'rules':_0x3d18f0});_0x582598[_0x39a813['id']]=_0x1fb748;}else _0x582598[_0x39a813['id']]='';}return this[_0x2e83b1(0x1f8)](),_0x582598;}[a65_0x4d113b(0x1f8)](){const _0x229f75=a65_0x4d113b;try{existsSync(this[_0x229f75(0x202)])&&rmSync(this[_0x229f75(0x202)],{'recursive':!![],'force':!![]});}catch(_0x140733){console[_0x229f75(0x1ec)]('Fail\x20to\x20remove\x20tmp\x20dir',_0x140733[_0x229f75(0x209)]);}}}module[a65_0x4d113b(0x20b)]=new OCR();