function a65_0x22ec(){const _0x435c7f=['296nOhVIp','410410xkDKNr','16079Ggmxcx','warn','503046FBJmHd','7aiDaUE','muted','Extracting\x20','.\x20Amount\x20of\x20items:\x20','105058brBgMr','Template\x20found:\x20','readImage','message','\x20from\x20','33BiMMeL','948Vvonhi','yfy-ocr','.\x20Similarity:\x20','Fail\x20to\x20remove\x20tmp\x20dir','2592HXVtIr','output_dir','por','file_attributes','__cleanup','cleanup','5PYwaYU','init','\x27s\x20text...','find','38511yyNpWg','template','info','exports','Finding\x20better\x20template\x20for\x20OCR...','1309388VZKUSS','readPDF','config','43147mVEPfn','rules'];a65_0x22ec=function(){return _0x435c7f;};return a65_0x22ec();}const a65_0x144a93=a65_0x59f0;(function(_0x284f25,_0x46048b){const _0x12c3f0=a65_0x59f0,_0x385f26=_0x284f25();while(!![]){try{const _0x11b7db=parseInt(_0x12c3f0(0x1e9))/0x1*(-parseInt(_0x12c3f0(0x1ed))/0x2)+-parseInt(_0x12c3f0(0x1e8))/0x3+parseInt(_0x12c3f0(0x1df))/0x4*(-parseInt(_0x12c3f0(0x1d6))/0x5)+parseInt(_0x12c3f0(0x1cc))/0x6*(parseInt(_0x12c3f0(0x1e6))/0x7)+parseInt(_0x12c3f0(0x1e4))/0x8*(parseInt(_0x12c3f0(0x1da))/0x9)+parseInt(_0x12c3f0(0x1e5))/0xa*(-parseInt(_0x12c3f0(0x1cb))/0xb)+-parseInt(_0x12c3f0(0x1d0))/0xc*(-parseInt(_0x12c3f0(0x1e2))/0xd);if(_0x11b7db===_0x46048b)break;else _0x385f26['push'](_0x385f26['shift']());}catch(_0x24ad37){_0x385f26['push'](_0x385f26['shift']());}}}(a65_0x22ec,0x3d98a));const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');function a65_0x59f0(_0x4c118b,_0x4c7d0c){const _0x22ec77=a65_0x22ec();return a65_0x59f0=function(_0x59f058,_0x46a61c){_0x59f058=_0x59f058-0x1cb;let _0x4eeb2c=_0x22ec77[_0x59f058];return _0x4eeb2c;},a65_0x59f0(_0x4c118b,_0x4c7d0c);}class OCR{[a65_0x144a93(0x1d7)](_0x668f8f={}){const _0x4b1ddc=a65_0x144a93,_0x469c36={'cleanup':!![],..._0x668f8f};this['output_dir']=resolve(os['tmpdir'](),_0x4b1ddc(0x1cd)),_0x469c36[_0x4b1ddc(0x1d5)]&&this[_0x4b1ddc(0x1d4)](),!existsSync(this[_0x4b1ddc(0x1d1)])&&mkdirSync(this['output_dir'],{'recursive':!![],'force':!![]});}async[a65_0x144a93(0x1e0)](_0xef5ef8){const _0x5c84d4=a65_0x144a93;this[_0x5c84d4(0x1d7)]();const _0x3bdac5=this['output_dir'],_0x3ef47d=await convertPDF(_0xef5ef8,{'output_dir':_0x3bdac5});return await this['readImage'](_0x3ef47d,{'cleanup':![]});}async[a65_0x144a93(0x1ef)](_0x594c31,_0x5b91de={}){const _0x52a7f7=a65_0x144a93;this[_0x52a7f7(0x1d7)](_0x5b91de);const _0x1d2d6b=this[_0x52a7f7(0x1d1)],_0x432ecd=await readLargeImage(_0x594c31,{'lang':_0x52a7f7(0x1d2),'output_dir':_0x1d2d6b});logger['info'](_0x52a7f7(0x1de));const _0x189550=await OCRTemplateApi[_0x52a7f7(0x1d9)](_0x432ecd);if(!_0x189550?.[_0x52a7f7(0x1db)])throw new ValidationError('OCR\x20Template\x20not\x20found.');const {items:_0x44aa9c,template:_0x10c7c1}=_0x189550,{width:_0x5b259c}=_0x10c7c1[_0x52a7f7(0x1d3)]||{'width':0x0};logger[_0x52a7f7(0x1ea)](_0x52a7f7(0x1ee)+_0x10c7c1['name']+_0x52a7f7(0x1f1)+_0x10c7c1['company_id']+_0x52a7f7(0x1ec)+_0x44aa9c['length']+_0x52a7f7(0x1ce)+_0x10c7c1['similarity']);const _0x2fc0c9={'__template':_0x10c7c1};for(const _0x183d32 of _0x44aa9c){logger[_0x52a7f7(0x1dc)](_0x52a7f7(0x1eb)+_0x183d32['id']+_0x52a7f7(0x1d8));const _0x44e43a=_0x183d32[_0x52a7f7(0x1e1)][_0x52a7f7(0x1e3)]||[],_0x30c68b=await cropImage(_0x183d32,_0x594c31,{'output_dir':_0x1d2d6b,'file_width':_0x5b259c});if(_0x30c68b&&existsSync(_0x30c68b)){const _0x3a3bc4=await readImage(_0x30c68b,{'output_dir':_0x1d2d6b,'rules':_0x44e43a});_0x2fc0c9[_0x183d32['id']]=_0x3a3bc4;}else _0x2fc0c9[_0x183d32['id']]='';}return this['__cleanup'](),_0x2fc0c9;}[a65_0x144a93(0x1d4)](){const _0x4861f9=a65_0x144a93;try{existsSync(this[_0x4861f9(0x1d1)])&&rmSync(this[_0x4861f9(0x1d1)],{'recursive':!![],'force':!![]});}catch(_0x23cd4a){console[_0x4861f9(0x1e7)](_0x4861f9(0x1cf),_0x23cd4a[_0x4861f9(0x1f0)]);}}}module[a65_0x144a93(0x1dd)]=new OCR();