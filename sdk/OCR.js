const a65_0xe3c1dc=a65_0x3e33;(function(_0x282ec3,_0x394618){const _0x309eee=a65_0x3e33,_0x1b7702=_0x282ec3();while(!![]){try{const _0x5cb36f=-parseInt(_0x309eee(0x15c))/0x1*(parseInt(_0x309eee(0x160))/0x2)+parseInt(_0x309eee(0x15b))/0x3*(-parseInt(_0x309eee(0x170))/0x4)+-parseInt(_0x309eee(0x174))/0x5+parseInt(_0x309eee(0x16c))/0x6+-parseInt(_0x309eee(0x17c))/0x7+-parseInt(_0x309eee(0x16f))/0x8*(-parseInt(_0x309eee(0x173))/0x9)+parseInt(_0x309eee(0x171))/0xa;if(_0x5cb36f===_0x394618)break;else _0x1b7702['push'](_0x1b7702['shift']());}catch(_0x430656){_0x1b7702['push'](_0x1b7702['shift']());}}}(a65_0x3aa7,0x41300));function a65_0x3e33(_0x2a43c5,_0x25b151){const _0x3aa741=a65_0x3aa7();return a65_0x3e33=function(_0x3e33cb,_0x5749dc){_0x3e33cb=_0x3e33cb-0x15a;let _0x4b3f83=_0x3aa741[_0x3e33cb];return _0x4b3f83;},a65_0x3e33(_0x2a43c5,_0x25b151);}const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');function a65_0x3aa7(){const _0x5291f6=['readPDF','28011JIiUUU','31hWRhpi','find','company_id','config','21556XixNOm','similarity','yfy-ocr','template','\x27s\x20text...','Finding\x20better\x20template\x20for\x20OCR...','.\x20Amount\x20of\x20items:\x20','init','muted','.\x20Similarity:\x20','message','Fail\x20to\x20remove\x20tmp\x20dir','2468994GaWnZW','tmpdir','output_dir','46264NuUnaw','64Lkmmnx','1721180bhSrVc','exports','702ERCWMK','370575osDCZk','info','Extracting\x20','OCR\x20Template\x20not\x20found.','readImage','rules','por','length','1470406GozjFY','__cleanup'];a65_0x3aa7=function(){return _0x5291f6;};return a65_0x3aa7();}class OCR{[a65_0xe3c1dc(0x167)](_0x2aa1ac={}){const _0x36cdc6=a65_0xe3c1dc,_0x4363c8={'cleanup':!![],..._0x2aa1ac};this[_0x36cdc6(0x16e)]=resolve(os[_0x36cdc6(0x16d)](),_0x36cdc6(0x162)),_0x4363c8['cleanup']&&this['__cleanup'](),!existsSync(this[_0x36cdc6(0x16e)])&&mkdirSync(this[_0x36cdc6(0x16e)],{'recursive':!![],'force':!![]});}async[a65_0xe3c1dc(0x15a)](_0x5e6465){const _0xf3e5e9=a65_0xe3c1dc;this[_0xf3e5e9(0x167)]();const _0x5e9b7d=this['output_dir'],_0x291b69=await convertPDF(_0x5e6465,{'output_dir':_0x5e9b7d});return await this['readImage'](_0x291b69,{'cleanup':![]});}async[a65_0xe3c1dc(0x178)](_0x1ae522,_0x2158d4={}){const _0x471349=a65_0xe3c1dc;this[_0x471349(0x167)](_0x2158d4);const _0x2e200d=this[_0x471349(0x16e)],_0x12c850=await readLargeImage(_0x1ae522,{'lang':_0x471349(0x17a),'output_dir':_0x2e200d});logger['info'](_0x471349(0x165));const _0x2ed162=await OCRTemplateApi[_0x471349(0x15d)](_0x12c850);if(!_0x2ed162?.[_0x471349(0x163)])throw new ValidationError(_0x471349(0x177));const {items:_0x44ba09,template:_0x1baca5}=_0x2ed162,{width:_0x32f18c}=_0x1baca5['file_attributes']||{'width':0x0};logger[_0x471349(0x168)]('Template\x20found:\x20'+_0x1baca5['name']+'\x20from\x20'+_0x1baca5[_0x471349(0x15e)]+_0x471349(0x166)+_0x44ba09[_0x471349(0x17b)]+_0x471349(0x169)+_0x1baca5[_0x471349(0x161)]);const _0x1febab={'__template':_0x1baca5};for(const _0x35468d of _0x44ba09){logger[_0x471349(0x175)](_0x471349(0x176)+_0x35468d['id']+_0x471349(0x164));const _0x4d1c4b=_0x35468d[_0x471349(0x15f)][_0x471349(0x179)]||[],_0x206d15=await cropImage(_0x35468d,_0x1ae522,{'output_dir':_0x2e200d,'file_width':_0x32f18c});if(_0x206d15&&existsSync(_0x206d15)){const _0x381d92=await readImage(_0x206d15,{'output_dir':_0x2e200d,'rules':_0x4d1c4b});_0x1febab[_0x35468d['id']]=_0x381d92;}else _0x1febab[_0x35468d['id']]='';}return this[_0x471349(0x17d)](),_0x1febab;}['__cleanup'](){const _0x5d9c9e=a65_0xe3c1dc;try{existsSync(this[_0x5d9c9e(0x16e)])&&rmSync(this[_0x5d9c9e(0x16e)],{'recursive':!![],'force':!![]});}catch(_0x533bf0){console['warn'](_0x5d9c9e(0x16b),_0x533bf0[_0x5d9c9e(0x16a)]);}}}module[a65_0xe3c1dc(0x172)]=new OCR();