function a65_0xd799(){const _0x147fcb=['Extracting\x20','output_dir','Template\x20found:\x20','cleanup','9BMCjNF','\x27s\x20text...','20955awUbwq','info','length','__cleanup','exports','OCR\x20Template\x20not\x20found.','472298jcEcRA','2830pwxVnL','rules','Finding\x20better\x20template\x20for\x20OCR...','Fail\x20to\x20remove\x20tmp\x20dir','muted','readPDF','2432402HdnIVK','init','\x20from\x20','yfy-ocr','config','217604BkjrRE','template','name','.\x20Amount\x20of\x20items:\x20','.\x20Similarity:\x20','156URGqid','find','303225luORTL','7029WsMykZ','por','498488ZSKIAx'];a65_0xd799=function(){return _0x147fcb;};return a65_0xd799();}const a65_0x47776c=a65_0x3119;function a65_0x3119(_0x4cf0ee,_0x25b89c){const _0xd7996a=a65_0xd799();return a65_0x3119=function(_0x311908,_0x5ab3b6){_0x311908=_0x311908-0x150;let _0x7666c4=_0xd7996a[_0x311908];return _0x7666c4;},a65_0x3119(_0x4cf0ee,_0x25b89c);}(function(_0x20495c,_0x286077){const _0x52aec3=a65_0x3119,_0x332025=_0x20495c();while(!![]){try{const _0x4906f3=parseInt(_0x52aec3(0x158))/0x1+parseInt(_0x52aec3(0x168))/0x2+parseInt(_0x52aec3(0x160))/0x3*(parseInt(_0x52aec3(0x151))/0x4)+parseInt(_0x52aec3(0x162))/0x5*(parseInt(_0x52aec3(0x156))/0x6)+-parseInt(_0x52aec3(0x16f))/0x7+-parseInt(_0x52aec3(0x15b))/0x8+-parseInt(_0x52aec3(0x159))/0x9*(parseInt(_0x52aec3(0x169))/0xa);if(_0x4906f3===_0x286077)break;else _0x332025['push'](_0x332025['shift']());}catch(_0x4f783a){_0x332025['push'](_0x332025['shift']());}}}(a65_0xd799,0x2c1f3));const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');class OCR{[a65_0x47776c(0x170)](_0x2c109f={}){const _0x48f2fc=a65_0x47776c,_0x43fe66={'cleanup':!![],..._0x2c109f};this[_0x48f2fc(0x15d)]=resolve(os['tmpdir'](),_0x48f2fc(0x172)),_0x43fe66[_0x48f2fc(0x15f)]&&this['__cleanup'](),!existsSync(this[_0x48f2fc(0x15d)])&&mkdirSync(this[_0x48f2fc(0x15d)],{'recursive':!![],'force':!![]});}async[a65_0x47776c(0x16e)](_0x2ed879){const _0x499b1d=a65_0x47776c;this[_0x499b1d(0x170)]();const _0x5697b0=this[_0x499b1d(0x15d)],_0x4622c5=await convertPDF(_0x2ed879,{'output_dir':_0x5697b0});return await this['readImage'](_0x4622c5,{'cleanup':![]});}async['readImage'](_0x120dbc,_0x2fe7b4={}){const _0x2b1c9b=a65_0x47776c;this[_0x2b1c9b(0x170)](_0x2fe7b4);const _0xb02de1=this[_0x2b1c9b(0x15d)],_0x33d0f6=await readLargeImage(_0x120dbc,{'lang':_0x2b1c9b(0x15a),'output_dir':_0xb02de1});logger['info'](_0x2b1c9b(0x16b));const _0x492c3e=await OCRTemplateApi[_0x2b1c9b(0x157)](_0x33d0f6);if(!_0x492c3e?.[_0x2b1c9b(0x152)])throw new ValidationError(_0x2b1c9b(0x167));const {items:_0x137440,template:_0x44c359}=_0x492c3e,{width:_0x4e04c3}=_0x44c359['file_attributes']||{'width':0x0};logger[_0x2b1c9b(0x16d)](_0x2b1c9b(0x15e)+_0x44c359[_0x2b1c9b(0x153)]+_0x2b1c9b(0x171)+_0x44c359['company_id']+_0x2b1c9b(0x154)+_0x137440[_0x2b1c9b(0x164)]+_0x2b1c9b(0x155)+_0x44c359['similarity']);const _0x56f56a={'__template':_0x44c359};for(const _0x227a98 of _0x137440){logger[_0x2b1c9b(0x163)](_0x2b1c9b(0x15c)+_0x227a98['id']+_0x2b1c9b(0x161));const _0x4801b0=_0x227a98[_0x2b1c9b(0x150)][_0x2b1c9b(0x16a)]||[],_0x1c5dea=await cropImage(_0x227a98,_0x120dbc,{'output_dir':_0xb02de1,'file_width':_0x4e04c3});if(_0x1c5dea&&existsSync(_0x1c5dea)){const _0x18207c=await readImage(_0x1c5dea,{'output_dir':_0xb02de1,'rules':_0x4801b0});_0x56f56a[_0x227a98['id']]=_0x18207c;}else _0x56f56a[_0x227a98['id']]='';}return this[_0x2b1c9b(0x165)](),_0x56f56a;}['__cleanup'](){const _0x132102=a65_0x47776c;try{existsSync(this[_0x132102(0x15d)])&&rmSync(this[_0x132102(0x15d)],{'recursive':!![],'force':!![]});}catch(_0x11be46){console['warn'](_0x132102(0x16c),_0x11be46['message']);}}}module[a65_0x47776c(0x166)]=new OCR();