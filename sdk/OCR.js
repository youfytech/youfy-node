const a65_0x3113f2=a65_0x57cc;function a65_0x57cc(_0x57c301,_0x1d43cc){const _0x1af28b=a65_0x1af2();return a65_0x57cc=function(_0x57cc57,_0x39b1e4){_0x57cc57=_0x57cc57-0x1c8;let _0x46e532=_0x1af28b[_0x57cc57];return _0x46e532;},a65_0x57cc(_0x57c301,_0x1d43cc);}(function(_0x4bbd94,_0xf5bc1){const _0x3f8641=a65_0x57cc,_0x5c1798=_0x4bbd94();while(!![]){try{const _0x12d496=-parseInt(_0x3f8641(0x1e7))/0x1*(parseInt(_0x3f8641(0x1dd))/0x2)+-parseInt(_0x3f8641(0x1d8))/0x3+-parseInt(_0x3f8641(0x1df))/0x4+-parseInt(_0x3f8641(0x1ce))/0x5*(parseInt(_0x3f8641(0x1d9))/0x6)+parseInt(_0x3f8641(0x1d2))/0x7+-parseInt(_0x3f8641(0x1ca))/0x8*(-parseInt(_0x3f8641(0x1e3))/0x9)+parseInt(_0x3f8641(0x1d1))/0xa;if(_0x12d496===_0xf5bc1)break;else _0x5c1798['push'](_0x5c1798['shift']());}catch(_0x1ec781){_0x5c1798['push'](_0x5c1798['shift']());}}}(a65_0x1af2,0x86761));const os=require('os'),{resolve}=require('path'),convertPDF=require('../ocr/convertPDF'),cropImage=require('../ocr/cropImage'),readImage=require('../ocr/readImage'),readLargeImage=require('../ocr/readLargeImage'),OCRTemplateApi=require('../api/OCRTemplate'),{existsSync,mkdirSync,rmSync}=require('fs'),logger=require('../sdk/Logger'),{ValidationError}=require('../exceptions');class OCR{[a65_0x3113f2(0x1da)](_0xf3a4a6={}){const _0x57590e=a65_0x3113f2,_0x56f081={'cleanup':!![],..._0xf3a4a6};this[_0x57590e(0x1d7)]=resolve(os[_0x57590e(0x1e0)](),_0x57590e(0x1e4)),_0x56f081[_0x57590e(0x1e1)]&&this['__cleanup'](),!existsSync(this['output_dir'])&&mkdirSync(this[_0x57590e(0x1d7)],{'recursive':!![],'force':!![]});}async['readPDF'](_0x814ba4){const _0x1ac0ff=a65_0x3113f2;this[_0x1ac0ff(0x1da)]();const _0xf829ea=this[_0x1ac0ff(0x1d7)],_0x43393f=await convertPDF(_0x814ba4,{'output_dir':_0xf829ea});return await this['readImage'](_0x43393f,{'cleanup':![]});}async[a65_0x3113f2(0x1cb)](_0x5413e7,_0x9b472f={}){const _0x4be89c=a65_0x3113f2;this[_0x4be89c(0x1da)](_0x9b472f);const _0xcd61f0=this[_0x4be89c(0x1d7)],_0x5eeb9f=await readLargeImage(_0x5413e7,{'lang':'por','output_dir':_0xcd61f0});logger[_0x4be89c(0x1cd)](_0x4be89c(0x1c9));const _0x40e97d=await OCRTemplateApi[_0x4be89c(0x1cc)](_0x5eeb9f);if(!_0x40e97d?.[_0x4be89c(0x1e5)])throw new ValidationError(_0x4be89c(0x1d3));const {items:_0x379f5b,template:_0x5f2ebd}=_0x40e97d,{width:_0x1de3d8}=_0x5f2ebd[_0x4be89c(0x1c8)]||{'width':0x0};logger[_0x4be89c(0x1e6)]('Template\x20found:\x20'+_0x5f2ebd['name']+_0x4be89c(0x1e2)+_0x5f2ebd[_0x4be89c(0x1d5)]+_0x4be89c(0x1d6)+_0x379f5b[_0x4be89c(0x1dc)]+'.\x20Similarity:\x20'+_0x5f2ebd[_0x4be89c(0x1e8)]);const _0x11ad7a={'__template':_0x5f2ebd};for(const _0x4c7cd4 of _0x379f5b){logger[_0x4be89c(0x1cd)](_0x4be89c(0x1e9)+_0x4c7cd4['id']+_0x4be89c(0x1d4));const _0x1f57ba=_0x4c7cd4[_0x4be89c(0x1db)][_0x4be89c(0x1d0)]||[],_0x262591=await cropImage(_0x4c7cd4,_0x5413e7,{'output_dir':_0xcd61f0,'file_width':_0x1de3d8});if(_0x262591&&existsSync(_0x262591)){const _0x12deed=await readImage(_0x262591,{'output_dir':_0xcd61f0,'rules':_0x1f57ba});_0x11ad7a[_0x4c7cd4['id']]=_0x12deed;}else _0x11ad7a[_0x4c7cd4['id']]='';}return this[_0x4be89c(0x1de)](),_0x11ad7a;}[a65_0x3113f2(0x1de)](){const _0x32a756=a65_0x3113f2;try{existsSync(this[_0x32a756(0x1d7)])&&rmSync(this[_0x32a756(0x1d7)],{'recursive':!![],'force':!![]});}catch(_0x3efff9){console['warn']('Fail\x20to\x20remove\x20tmp\x20dir',_0x3efff9['message']);}}}module[a65_0x3113f2(0x1cf)]=new OCR();function a65_0x1af2(){const _0x10efb8=['info','609870kpZWDG','exports','rules','7172230FzMgrb','2337230eBtJAg','OCR\x20Template\x20not\x20found.','\x27s\x20text...','company_id','.\x20Amount\x20of\x20items:\x20','output_dir','284607WamMVG','18pEfdva','init','config','length','258764tiHgej','__cleanup','438788fsVFND','tmpdir','cleanup','\x20from\x20','740007QZiYeM','yfy-ocr','template','muted','2jjyYwf','similarity','Extracting\x20','file_attributes','Finding\x20better\x20template\x20for\x20OCR...','32zVnEQi','readImage','find'];a65_0x1af2=function(){return _0x10efb8;};return a65_0x1af2();}